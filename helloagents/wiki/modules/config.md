# config

## 目的
维护构建与站点配置。

## 模块概述
- **职责:** 配置文件与构建参数管理
- **状态:** ✅稳定
- **最后更新:** 2026-01-20

## 规范

### 需求: 配置维护
**模块:** config
配置变更需保持与运行环境一致。

#### 场景: 日常更新
调整配置时同步验证构建行为。
- 站点可正常构建
- 配置项有注释或说明

### 需求: 流水线构建
**模块:** config
镜像构建流水线需支持多架构镜像输出。

#### 场景: 双架构镜像
构建镜像时需同时输出 linux/amd64 与 linux/arm64。
- 保持现有标签策略
- 允许流水线耗时合理增加

#### 场景: 构建缓存
为 Buildx 启用缓存以降低构建耗时。
- 使用 GHA 缓存（cache-from/cache-to）
- 依赖层变更最小化以提升命中率

#### 场景: 原生 ARM 构建
使用官方 arm64 Runner 进行原生构建，避免 QEMU。
- arm64 使用 ubuntu-24.04-arm
- 通过 manifest 合并输出双架构镜像

### 需求: PR 预览环境流水线
**模块:** config
PR 触发时更新预览环境镜像。

#### 场景: Preview 更新镜像
使用 `KUBE_BASE64` secrets 配置 kubectl 并执行 `kubectl set image`。
- 仅更新镜像，不做其他部署变更
- 命名空间与镜像仓库通过仓库变量配置

## API接口
暂无

## 数据模型
暂无

## 依赖
- 待补充

## 变更历史
- [202601201927_pr-preview-workflow](../../history/2026-01/202601201927_pr-preview-workflow/) - 新增 PR 预览环境工作流
